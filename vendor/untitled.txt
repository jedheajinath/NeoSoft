
<div class="allpost">
<% @posts.each do |post| %>     
    <div class="wrapper">
        <div class="post bg-info" style="padding:5px;background:#ffccaa;margin:0px">
           <h4 class="text-primary"><%= post.content %> </h4>
           Auther- <strong><%= post.get_uname %> </strong> <br>
           At -<%= post.created_at %>
        </div>  

        <div class="clearfix"> </div>

        <div class="oldcomment" style="padding:7px;">
           <% post.get_comment.each do |comment| %>
              <div class="bg-success" id="oldcomment<%=comment.id%>" style="margin:2px">
                <%= comment.message %> - By 
                <strong><%= post.get_c_uname(comment.user_id) %> </strong>


                <div class="pull-right">
                 <% if comment.user_id == current_user.id %>
                    
                     <a class="pad5" data-confirm="Are You Sure?" rel="nofollow" data-method="delete" href="/comments/<%=comment.id%>"><i class="fa fa-trash-o"></i></a>
                     <a href="#" class="pad5" id="editscomment<%=comment.id%>" data-remote="true" ><i class="fa fa-pencil-square-o"></i></a>
                     
                                         
                     <% elsif post.user_id== current_user.id %>
                    <a data-confirm="Are You Sure?" rel="nofollow" data-method="delete" href="/comments/<%=comment.id%>"><i class="fa fa-trash-o"></i></a>
                   
                 <% end %>

                    <a href="#" class="pad5" id="subcom<%=comment.id%>" data-remote="true" ><i class="fa fa-comment"></i></a>

                 </div>
                 
              </div>

              <div>
                     <% comment.get_child_comment.each do |subcom|  %>
                     <div > 
                          <%= subcom.message %> 
                          By -<strong><%= subcom.get_c_uname(subcom.user_id) %> </strong>
                     <div>  
                    <% end %> <br> 
              <div>   

              
              
              <div class="" id="subcomment<%=comment.id%>" style="display:none">
                     <%= render :partial=> "site/subcomment" , :locals => {:comment => comment} %>
              </div> 

              <div id="currenteditcomment<%=comment.id%>" style="display:none">
                  <%= render :partial=> "site/edit_comment" , :locals => {:comment => comment } %>
              </div>
                    <script type="text/javascript">
                         $(document).ready(function(){
                             $('#editscomment<%=comment.id%>').click(function(){
                              
                               $("#oldcomment<%=comment.id%>").hide();
                               $("#currenteditcomment<%=comment.id%>").show();
                               }),
                             $('#subcom<%=comment.id%>').click(function(){
                                $("#subcomment<%=comment.id%>").show();
                               });
                           });
                    </script>
              
           <% end %>
        </div> 



        <div class="comment" id="comment<%=post.id%>" style="display:none"> <br>
           <%= render :partial=> "comment" , :locals => {:object => post} %>
        </div>

        <div class="editcomment" id="editcomment<%=post.id%>" style="display:none">
                 <%= render :partial=> "site/edit_post" , :locals => {:post => post} %>
        </div>

        <div class="clearfix"> </div>
        <div class="edit">
            <% if post.user_id == current_user.id %>
                <div class="edc bg-default" id="edit<%=post.id%>">
                  <%= link_to 'edit' ,:remote => "true" %><i class="fa fa-pencil-square-o"></i>
                </div>
                <div class="edc bg-danger" style="padding:1px;">
                  <a data-confirm="Are You Sure?" rel="nofollow" data-method="delete" href="/posts/<%=post.id%>"><i class="fa fa-trash-o"></i> Delete</a>
                </div>
            <% end %>
            <div class="edc bg-default" style="background:#CED8F6;padding:1px;" id="<%=post.id %>"> 
                 <%= link_to 'comment', :remote => "true" %><i class="fa fa-comment"></i> 
            </div>
        </div>
        <div class="clearfix"> </div>

    </div>

  <script type="text/javascript">
   $(document).ready(function(){
     $('#<%=post.id%>').click(function(){
     $(this).hide();
     $('#comment<%=post.id%>').css("display","block");
    }),
     $('#edit<%=post.id%>').click(function(){
      $(this).hide();
      $("#editcomment<%=post.id%>").css("display","block");
     });
  });
  </script>
  <br>
  <% end %>
</div>


